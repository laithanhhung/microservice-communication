---
interface Props {
    width?: number; // Length of the arrow in pixels
    rotate?: number; // Rotation angle in degrees
    isAnimate?: boolean; // Enable dash flow animation
    color?: string; // Optional color
}

const {
    width = 200,
    rotate = 0,
    isAnimate = false,
    color = "#9CA3AF",
} = Astro.props;

// Calculate dash array - 4px dash, 4px gap
const dashArray = "4 4";
---

<div
    class="connection-arrow absolute transform origin-left"
    style={`width: ${width}px; transform: rotate(${rotate}deg);`}
>
    <svg width="100%" height="20" class="overflow-visible pointer-events-none">
        <defs>
            <marker
                id={`arrowhead-${width}-${rotate}`}
                markerWidth="10"
                markerHeight="7"
                refX="9"
                refY="3.5"
                orient="auto"
            >
                <polygon points="0 0, 10 3.5, 0 7" fill={color}></polygon>
            </marker>
        </defs>

        <line
            x1="0"
            y1="10"
            x2={width - 8}
            y2="10"
            stroke={color}
            stroke-width="2"
            stroke-dasharray={dashArray}
            marker-end={`url(#arrowhead-${width}-${rotate})`}
            class={isAnimate ? "animate-flow" : ""}></line>
    </svg>
</div>

<style>
    .connection-arrow {
        /* Ensure z-index is handled by parent or Tailwind classes if needed */
    }

    .animate-flow {
        animation: flow 1s linear infinite;
    }

    @keyframes flow {
        from {
            stroke-dashoffset: 8;
        }
        to {
            stroke-dashoffset: 0;
        }
    }
</style>
