---
import TopicNode from "./layout/TopicNode.astro";
import CentralSwitch from "./layout/CentralSwitch.astro";
import LegendList from "./layout/LegendList.astro";

import PatternSharedData from "./diagrams/PatternSharedData.astro";
import PatternEventDriven from "./diagrams/PatternEventDriven.astro";
import PatternAsync from "./diagrams/PatternAsync.astro";
import PatternSyncHTTP from "./diagrams/PatternSyncHTTP.astro";

import ConnectorLine from "./atoms/ConnectorLine.astro";
---

<div class="diagram-frame">

    <div class="relative grid grid-cols-1 lg:grid-cols-3 gap-12 mb-20 z-10">
        <!-- Top Row -->
        <PatternSharedData />
        <PatternEventDriven />
        <PatternAsync />

        <!-- Middle Row Logic (Visual placement) -->
        <!-- The grid structure implies flowing content. 
         We need specific placement for TopicNode and CentralSwitch. 
         We can use grid-row/col manipulation or absolute positioning for the 'Hub' effect if strict grid is hard.
         Let's stick to the 3-col grid concept for the main blocks, but 'CentralSwitch' sits in the middle.
    -->
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-12 relative z-10 mb-12">
        <!-- Left: Topic Node (Spans? Or just sits in Col 1) -->
        <div class="flex items-center justify-center">
            <TopicNode />
        </div>

        <!-- Center: Switch -->
        <div class="flex items-center justify-center relative">
            <CentralSwitch />

            <!-- Central Hub Connections (Overlay) -->
            <div class="absolute inset-0 pointer-events-none z-0">
                <!-- To Shared Data (Top Left) - Yellow -->
                <div
                    class="absolute top-[20%] left-[15%] -translate-x-1/2 -translate-y-1/2"
                >
                    <ConnectorLine
                        width={250}
                        isAnimate={true}
                        color="#0ea5a4"
                        rotate={210}
                    />
                </div>

                <!-- To Event Driven (Top Center) - Green -->
                <div
                    class="absolute top-0 left-1/2 -translate-x-1/2 -translate-y-1/2"
                >
                    <ConnectorLine
                        width={95}
                        isAnimate={true}
                        color="#0ea5a4"
                        rotate={-90}
                    />
                </div>

                <!-- To Async (Top Right) - Pink -->
                <div
                    class="absolute top-[20%] right-[15%] translate-x-1/2 -translate-y-1/2"
                >
                    <ConnectorLine
                        width={250}
                        isAnimate={true}
                        color="#0ea5a4"
                        rotate={-30}
                    />
                </div>

                <!-- To Sync HTTP (Bottom Right) - Pink -->
                <div
                    class="absolute bottom-[30%] right-[15%] translate-x-1/2 translate-y-1/2"
                >
                    <ConnectorLine
                        width={150}
                        isAnimate={true}
                        color="#f59e0b"
                        rotate={30}
                    />
                </div>
            </div>
        </div>

        <!-- Right: Empty or spacing? -->
        <!-- Actually, the 4th diagram (SyncHTTP) goes to Bottom Right.
            But in the original grid, it was 2 cols at bottom.
            Let's adapt:
            Row 2: Topic | Switch | [Gap/Spacer]
            Row 3: Legend | [Gap] | SyncHTTP
       -->
        <div class="hidden lg:block"></div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 relative">
        <LegendList />
        <PatternSyncHTTP />
    </div>
</div>
